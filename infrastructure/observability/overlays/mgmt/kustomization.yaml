---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

labels:
  - pairs:
      env: mgmt
      tier: infra

patches:
  - patch: |-
      - op: add
        path: /metadata/annotations/argocd.argoproj.io~1sync-wave
        value: "1"
    target:
      group: monitoring.coreos.com
      version: v1
      kind: ServiceMonitor
  - patch: |-
      - op: add
        path: /metadata/annotations/argocd.argoproj.io~1sync-wave
        value: "1"
    target:
      group: monitoring.coreos.com
      version: v1
      kind: PrometheusRule

helmGlobals:
  chartHome: /tmp

helmCharts:
  - name: kube-prometheus-stack
    repo: https://prometheus-community.github.io/helm-charts
    version: 69.6.0
    releaseName: prometheus
    namespace: observability
    valuesFile: values.yaml
    includeCRDs: true    